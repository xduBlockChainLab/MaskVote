# MaskVote
An anonymous vote system based on Blockchain.

基于Hyperledger Fabric和bulletproof零知识证明的匿名投票演示系统。

## 目录结构

包含三个java工程，对应系统中的三个角色，分别是投票员，计票员和管理员。```abstore.go```是需要部署在fabric上的智能合约。

## 底层思路

1. 首先投票者进行注册，和他交互的是协调者。投票者输入ID号。则返回自己的私钥，公钥保存在协调者的本地。
- 计票员在本地进行注册，私钥$x_i$保存本地，公钥$y_i=h^{x_i}$上传至区块链上。其中一名计票员从链上获取其他计票员的公钥，进行联合公钥$Y = \prod_{i=1}^t y_i$的计算，并上传至区块链上。其他的计票员可以验证联合公钥的正确性。
- 投票者首先从链上获取联合公钥$Y$，进行加密自己的选票信息$(g^dY^r, h^r)$，并生成自己的零知识证明(包括范围证明、指数相等证明、可验证加密：确实使用联合公钥加密)，然后将选票信息上传至区块链上。
- 所有的计票员都从链上获取每一条选票信息，拉取到本地之后，进行零知识证明；之后计算选票信息的累积乘$(g^{\sum d}Y^R, h^R)$，其中我们要求$\sum d$需要知道$Y^R$，相除之后查表就会知道g的指数。现在如何计算$Y^R = (h^{\sum x_i})^R = (h^R)^{\sum x_i} = \prod_{i=1}^{t}h^{Rx_i}$。所以计票员把加密的第一部分累积乘$g^{\sum d}Y^R$保存本地，加密的第二部分累积乘$h^R$在用计票员自己的私钥加密$h^{Rx_i}$，然后上传至上链。
- 其中的一名计票员从链上获取其他计票员的加密第二部分，然后算出$Y^R$，然后算出$g^{sum}$查表得到投票的数量。

> 在系统的测试中，我们先把三个计票员的公私钥提前初始化好，并且计算出联合公钥。把者四个全局变量上传至链上，供其他的参与者验证。

